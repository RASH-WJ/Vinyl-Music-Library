(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2f057ce6"],{2532:function(t,s,i){"use strict";var a=i("23e7"),e=i("5a34"),r=i("1d80"),c=i("ab13");a({target:"String",proto:!0,forced:!c("includes")},{includes:function(t){return!!~String(r(this)).indexOf(e(t),arguments.length>1?arguments[1]:void 0)}})},"2d3b":function(t,s,i){"use strict";i.r(s);var a=function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{staticClass:"search"},[i("div",{staticClass:"topnav"},[i("div",{staticClass:"back"},[i("van-icon",{attrs:{name:"arrow-left",color:"#fff",size:"20"},on:{click:t.goBack}})],1),i("div",{staticClass:"search-box"},[i("van-search",{ref:"searchIpt",attrs:{placeholder:"请输入搜索关键词"},on:{input:t.searchInput,search:t.search},model:{value:t.iptValue,callback:function(s){t.iptValue=s},expression:"iptValue"}})],1)]),t.historyList.length>0?i("div",{staticClass:"history-wrapper"},[i("div",{staticClass:"title clearfix"},[i("div",{staticClass:"fl"},[t._v("历史搜索")]),i("div",[i("div",{staticClass:"fr remove-icon"},[i("van-icon",{attrs:{name:"delete",size:"16"},on:{click:t.empty}})],1),i("div",{staticClass:"fr clear"},[t._v("清空")])])]),i("div",{staticClass:"history clearfix"},[i("div",{staticClass:"history-box"},t._l(t.historyList,(function(s,a){return i("div",{key:a,staticClass:"history-item fl",on:{click:function(i){return t.cloudsearch(s)}}},[t._v(t._s(s))])})),0)])]):t._e(),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.isSearch,expression:"!isSearch"}],staticClass:"hot-rank"},[i("div",{staticClass:"title"},[t._v("热搜榜")]),t._l(t.hotData,(function(s,a){return i("div",{key:a,staticClass:"hot-item",on:{click:function(i){return t.cloudsearch(s.searchWord)}}},[i("div",{staticClass:"hot-index",class:{active:a<=2}},[t._v(t._s(a+1))]),i("div",{staticClass:"hot-info"},[i("div",{staticClass:"song-name clearfix"},[i("div",{staticClass:"fl"},[t._v(t._s(s.searchWord))]),1==s.iconType?i("span",{staticClass:"type fl"},[i("img",{staticClass:"auto-img",attrs:{src:s.iconUrl}})]):t._e()]),i("div",{staticClass:"song-desc"},[t._v(t._s(s.content))])]),i("div",{staticClass:"hot-score"},[t._v(t._s(s.score))])])}))],2),i("div",{directives:[{name:"show",rawName:"v-show",value:t.isSuggest,expression:"isSuggest"}],staticClass:"search-suggest"},t._l(t.searchMatch,(function(s,a){return i("div",{key:a,staticClass:"suggest-msg",on:{click:function(i){return t.cloudsearch(s.keyword)}}},[t._v(t._s(s.keyword))])})),0),i("div",{directives:[{name:"show",rawName:"v-show",value:t.isSearch,expression:"isSearch"}],staticClass:"search-match"},[i("div",{staticClass:"title"},[t._v("单曲")]),t._l(t.matchSong,(function(s,a){return i("div",{key:a,staticClass:"song-item",on:{click:function(i){return t.getItem(s)}}},[i("div",{staticClass:"song-info"},[i("div",{staticClass:"songname one-text"},[t._v(t._s(s.name))]),i("div",{staticClass:"singer"},[t._v(t._s(s.ar[0].name))])]),i("div",{staticClass:"play-icon"},[t.currentSong.id==s.id?i("van-icon",{attrs:{name:"volume-o",color:"#feef9a",size:"20"}}):i("van-icon",{attrs:{name:"play-circle-o",size:"20"}})],1)])}))],2)])},e=[],r=(i("caad"),i("c975"),i("a434"),i("2532"),i("5530")),c=(i("4de5"),i("2f62")),o={name:"Search",data:function(){return{iptValue:"",isSearch:!1,isSuggest:!1,active:0,hotData:[],searchMatch:[],matchSong:[],historyList:[]}},computed:Object(r["a"])({},Object(c["b"])(["playing","playList","currentSong"])),created:function(){var t=this;this.getHot(),this.$nextTick((function(){var s=t.$refs.searchIpt.querySelector('[type="search"]');s.focus()}));var s=localStorage.getItem("historyList");s&&(this.historyList=JSON.parse(s))},methods:{goBack:function(){this.$router.go(-1)},getHot:function(){var t=this;this.axios({methods:"GET",url:"/search/hot/detail"}).then((function(s){200==s.data.code&&(t.hotData=s.data.data)})).catch((function(t){}))},searchInput:function(){var t=this,s=/^[ ]+$/;if(""==this.iptValue||s.test(this.iptValue))return this.iptValue="",void(this.isSuggest=!1);this.isSuggest=!0,this.axios({methods:"GET",url:"/search/suggest",params:{keywords:this.iptValue,type:"mobile"}}).then((function(s){if(200==s.data.code){var i=s.data.result.allMatch;t.searchMatch=i}})).catch((function(t){}))},search:function(){var t=/^[ ]+$/;if(""==this.iptValue||t.test(this.iptValue))return this.$toast("请输入搜索内容"),void(this.iptValue="");this.setHistory(this.iptValue),this.isSuggest=!1,this.cloudsearch(this.iptValue)},cloudsearch:function(t){var s=this;this.setHistory(t),this.iptValue=t,this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0}),this.axios({methods:"GET",url:"/cloudsearch",params:{keywords:t}}).then((function(t){if(200==t.data.code){s.$toast.clear(),s.isSearch=!0,s.isSuggest=!1;var i=t.data.result.songs;s.matchSong=i}})).catch((function(t){s.$toast.clear()}))},empty:function(){localStorage.removeItem("historyList"),this.historyList=[]},getItem:function(t){var s=this;this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0}),this.axios({method:"GET",url:"/song/url",params:{id:t.id}}).then((function(i){var a=i.data.data[0].url;200==i.data.code&&(s.$toast.clear(),t.songUrl=a,t.picUrl=t.al.picUrl,s.$store.commit("setCurrentSong",t),s.$store.commit("playStatus",!0),s.$store.dispatch("HandlePlayList",t))})).catch((function(t){s.$toast.clear()}))},setHistory:function(t){if(0==this.historyList.length)this.historyList.unshift(t);else if(this.historyList.includes(t)){var s=this.historyList.indexOf(t);this.historyList.splice(s,1),this.historyList.unshift(t)}else this.historyList.unshift(t);localStorage.setItem("historyList",JSON.stringify(this.historyList))}}},n=o,h=i("2877"),l=Object(h["a"])(n,a,e,!1,null,null,null);s["default"]=l.exports},"4de5":function(t,s,i){},"5a34":function(t,s,i){var a=i("44e7");t.exports=function(t){if(a(t))throw TypeError("The method doesn't accept regular expressions");return t}},ab13:function(t,s,i){var a=i("b622"),e=a("match");t.exports=function(t){var s=/./;try{"/./"[t](s)}catch(i){try{return s[e]=!1,"/./"[t](s)}catch(a){}}return!1}},c975:function(t,s,i){"use strict";var a=i("23e7"),e=i("4d64").indexOf,r=i("a640"),c=i("ae40"),o=[].indexOf,n=!!o&&1/[1].indexOf(1,-0)<0,h=r("indexOf"),l=c("indexOf",{ACCESSORS:!0,1:0});a({target:"Array",proto:!0,forced:n||!h||!l},{indexOf:function(t){return n?o.apply(this,arguments)||0:e(this,t,arguments.length>1?arguments[1]:void 0)}})},caad:function(t,s,i){"use strict";var a=i("23e7"),e=i("4d64").includes,r=i("44d2"),c=i("ae40"),o=c("indexOf",{ACCESSORS:!0,1:0});a({target:"Array",proto:!0,forced:!o},{includes:function(t){return e(this,t,arguments.length>1?arguments[1]:void 0)}}),r("includes")}}]);
//# sourceMappingURL=chunk-2f057ce6.89fb08c1.js.map